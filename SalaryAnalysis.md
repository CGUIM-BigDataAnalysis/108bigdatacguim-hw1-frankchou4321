108-2 大數據分析方法 作業一
================
B0544138 周孫群

搞不清楚各行各業的薪資差異嗎? 念研究所到底對第一份工作的薪資影響有多大? CP值高嗎? 透過分析**初任人員平均經常性薪資**-
（107年）<https://data.gov.tw/dataset/6647>
（104-105年）<http://ipgod.nchc.org.tw/dataset/a17000000j-020066>
，可初步了解台灣近幾年各行各業、各學歷的起薪。

## 比較104年度和107年度大學畢業者的薪資資料

### 資料匯入與處理

``` r
library(readr)
library(dplyr)
```

    ## 
    ## Attaching package: 'dplyr'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     filter, lag

    ## The following objects are masked from 'package:base':
    ## 
    ##     intersect, setdiff, setequal, union

``` r
library(readr)

#匯入104與107年的薪資資料
X104MonthSalary <- read_csv("C:/Users/asus/Desktop/Bigdatahw1/a17000000j-020066-mah.csv")
```

    ## Parsed with column specification:
    ## cols(
    ##   年度 = col_double(),
    ##   大職業別 = col_character(),
    ##   `經常性薪資-薪資` = col_double(),
    ##   `經常性薪資-女/男` = col_character(),
    ##   `國中及以下-薪資` = col_character(),
    ##   `國中及以下-女/男` = col_character(),
    ##   `高中或高職-薪資` = col_character(),
    ##   `高中或高職-女/男` = col_character(),
    ##   `專科-薪資` = col_character(),
    ##   `專科-女/男` = col_character(),
    ##   `大學-薪資` = col_character(),
    ##   `大學-女/男` = col_character(),
    ##   `研究所及以上-薪資` = col_character(),
    ##   `研究所及以上-女/男` = col_character()
    ## )

``` r
X107MonthSalary <- read_csv("C:/Users/asus/Desktop/Bigdatahw1/107MonthSalary.csv")
```

    ## Parsed with column specification:
    ## cols(
    ##   年度 = col_double(),
    ##   大職業別 = col_character(),
    ##   `經常性薪資-薪資` = col_character(),
    ##   `經常性薪資-女/男` = col_character(),
    ##   `國中及以下-薪資` = col_character(),
    ##   `國中及以下-女/男` = col_character(),
    ##   `高中或高職-薪資` = col_character(),
    ##   `高中或高職-女/男` = col_character(),
    ##   `專科-薪資` = col_character(),
    ##   `專科-女/男` = col_character(),
    ##   `大學-薪資` = col_character(),
    ##   `大學-女/男` = col_character(),
    ##   `研究所-薪資` = col_character(),
    ##   `研究所-女/男` = col_character()
    ## )

``` r
#將104薪資檔案中"大職業別"的資料進行字串取代，以符合107年度的資料型態
X104MonthSalary$"大職業別"<-
  gsub("、","_",X104MonthSalary$"大職業別")

#使用inner_join 將兩個資料合併
X104107MonthSalary<-inner_join(X104MonthSalary,X107MonthSalary ,by="大職業別")

#將沒有資料的大學薪資欄位值改為NA
X104107MonthSalary$`大學-薪資.x`<-gsub("—",NA,X104107MonthSalary$`大學-薪資.x`)
X104107MonthSalary$`大學-薪資.y`<-gsub("—",NA,X104107MonthSalary$`大學-薪資.y`)
X104107MonthSalary$`大學-薪資.y`<-gsub("…",NA,X104107MonthSalary$`大學-薪資.y`)

#將薪資資料轉為數值
X104107MonthSalary$`大學-薪資.x`<-as.numeric(X104107MonthSalary$`大學-薪資.x`)
X104107MonthSalary$`大學-薪資.y`<-as.numeric(X104107MonthSalary$`大學-薪資.y`)
```

### 107年度薪資較104年度薪資高的職業有哪些?

``` r
#用filter()篩選出107年薪資比104年高的值
higher107<-filter(X104107MonthSalary,`大學-薪資.y`>`大學-薪資.x`)

#用mutate()新增107年大學薪資除以104年度的欄位，並由大到小做排序
X104107MonthSalary_ratesort <- mutate(X104107MonthSalary,Rate=`大學-薪資.y`/`大學-薪資.x`)%>%arrange(desc(Rate))

#用select()選出所要的欄位，並選出前十筆
X104_107top10 <- select(X104107MonthSalary_ratesort,大職業別,年度.x,`大學-薪資.x`,年度.y,`大學-薪資.y`)%>%head(10)
knitr::kable(X104_107top10)
```

| 大職業別                       | 年度.x | 大學-薪資.x | 年度.y | 大學-薪資.y |
| :------------------------- | :--: | :-----: | :--: | :-----: |
| 專業\_科學及技術服務業-服務及銷售工作人員     | 2015 |  24423  | 2018 |  28304  |
| 不動產業-技術員及助理專業人員            | 2015 |  27338  | 2018 |  30914  |
| 住宿及餐飲業-服務及銷售工作人員           | 2015 |  23548  | 2018 |  26111  |
| 藝術\_娛樂及休閒服務業-事務支援人員        | 2015 |  24244  | 2018 |  26611  |
| 金融及保險業-技藝\_機械設備操作及組裝人員     | 2015 |  30074  | 2018 |  32997  |
| 用水供應及污染整治業-專業人員            | 2015 |  32179  | 2018 |  34957  |
| 住宿及餐飲業                     | 2015 |  25167  | 2018 |  27213  |
| 用水供應及污染整治業-技藝\_機械設備操作及組裝人員 | 2015 |  27887  | 2018 |  29909  |
| 電力及燃氣供應業-技藝\_機械設備操作及組裝人員   | 2015 |  28039  | 2018 |  30031  |
| 住宿及餐飲業-事務支援人員              | 2015 |  24786  | 2018 |  26538  |

### 提高超過5%的的職業有哪些?

``` r
#新增Rate欄位，然後篩選大於1.05的資料
X104107MonthSalary <- mutate(X104107MonthSalary ,Rate=`大學-薪資.y`/`大學-薪資.x`)%>%arrange(desc(Rate))
over1.05<-filter(X104107MonthSalary,Rate>1.05)
over1.05<-filter(X104107MonthSalary,Rate>1.05)%>%select(大職業別,Rate)
knitr::kable(over1.05)
```

| 大職業別                         |     Rate |
| :--------------------------- | -------: |
| 專業\_科學及技術服務業-服務及銷售工作人員       | 1.158908 |
| 不動產業-技術員及助理專業人員              | 1.130807 |
| 住宿及餐飲業-服務及銷售工作人員             | 1.108842 |
| 藝術\_娛樂及休閒服務業-事務支援人員          | 1.097632 |
| 金融及保險業-技藝\_機械設備操作及組裝人員       | 1.097194 |
| 用水供應及污染整治業-專業人員              | 1.086330 |
| 住宿及餐飲業                       | 1.081297 |
| 用水供應及污染整治業-技藝\_機械設備操作及組裝人員   | 1.072507 |
| 電力及燃氣供應業-技藝\_機械設備操作及組裝人員     | 1.071044 |
| 住宿及餐飲業-事務支援人員                | 1.070685 |
| 運輸及倉儲業-技術員及助理專業人員            | 1.070003 |
| 金融及保險業-技術員及助理專業人員            | 1.069093 |
| 金融及保險業-服務及銷售工作人員             | 1.068089 |
| 不動產業                         | 1.066421 |
| 運輸及倉儲業-技藝\_機械設備操作及組裝人員       | 1.065723 |
| 不動產業-技藝\_機械設備操作及組裝人員         | 1.063403 |
| 住宿及餐飲業-技藝\_機械設備操作及組裝人員       | 1.062300 |
| 不動產業-服務及銷售工作人員               | 1.062117 |
| 支援服務業-服務及銷售工作人員              | 1.060903 |
| 運輸及倉儲業-事務支援人員                | 1.060240 |
| 藝術\_娛樂及休閒服務業                 | 1.059809 |
| 其他服務業-服務及銷售工作人員              | 1.056991 |
| 藝術\_娛樂及休閒服務業-專業人員            | 1.056577 |
| 運輸及倉儲業                       | 1.056260 |
| 藝術\_娛樂及休閒服務業-技藝\_機械設備操作及組裝人員 | 1.055985 |
| 製造業-技術員及助理專業人員               | 1.055015 |
| 運輸及倉儲業-服務及銷售工作人員             | 1.054221 |
| 金融及保險業                       | 1.053951 |
| 不動產業-事務支援人員                  | 1.053410 |
| 金融及保險業-專業人員                  | 1.052928 |
| 批發及零售業-服務及銷售工作人員             | 1.052818 |
| 製造業-專業人員                     | 1.052507 |
| 用水供應及污染整治業                   | 1.051960 |
| 藝術\_娛樂及休閒服務業-技術員及助理專業人員      | 1.051427 |

### 主要的職業種別是哪些種類呢?

``` r
#利用strsplit()將大職業別的欄位資料用"-"做切割，再用迴圈取出"-"前的值
category<-strsplit(over1.05$大職業別,"-")[[1]][1]
for(i in 2:length(over1.05$大職業別)){
  category<-c(category,strsplit(over1.05$大職業別,"-")[[i]][1])
}
#用table()計算各個職業類別出現個數
knitr::kable(maincareer<-table(category)%>%data.frame()%>%arrange(desc(Freq)))
```

| category     | Freq |
| :----------- | ---: |
| 不動產業         |    5 |
| 金融及保險業       |    5 |
| 運輸及倉儲業       |    5 |
| 藝術\_娛樂及休閒服務業 |    5 |
| 住宿及餐飲業       |    4 |
| 用水供應及污染整治業   |    3 |
| 製造業          |    2 |
| 支援服務業        |    1 |
| 批發及零售業       |    1 |
| 其他服務業        |    1 |
| 專業\_科學及技術服務業 |    1 |
| 電力及燃氣供應業     |    1 |

## 男女同工不同酬現況分析

男女同工不同酬一直是性別平等中很重要的問題，分析資料來源為103到106年度的大學畢業薪資。

### 104和107年度的大學畢業薪資資料，哪些行業男生薪資比女生薪資多?

``` r
##104年度
#先將104欄位資料清洗後再轉為numeric
X104MonthSalary$`大學-女/男` <- gsub("…",NA,X104MonthSalary$`大學-女/男`)   
X104MonthSalary$`大學-女/男` <- gsub("—",NA,X104MonthSalary$`大學-女/男`)
X104MonthSalary$`大學-女/男` <- as.numeric(X104MonthSalary$`大學-女/男`)

#篩選女生比男生的比率小於100的資料
MLhigher104 <- filter(X104MonthSalary,`大學-女/男`<100)%>% arrange(`大學-女/男`)

#取出前10筆資料
MLheadin104<-head(MLhigher104,10)
knitr::kable(MLheadin104)
```

|  年度  | 大職業別                       | 經常性薪資-薪資 | 經常性薪資-女/男 | 國中及以下-薪資 | 國中及以下-女/男 | 高中或高職-薪資 | 高中或高職-女/男 | 專科-薪資 | 專科-女/男 | 大學-薪資 | 大學-女/男 | 研究所及以上-薪資 | 研究所及以上-女/男 |
| :--: | :------------------------- | :------: | :-------- | :------- | :-------- | :------- | :-------- | :---- | :----- | :---- | :----: | :-------- | :--------- |
| 2015 | 電力及燃氣供應業-技藝\_機械設備操作及組裝人員   |  27924   | 90.46     | —        | —         | 27785    | 89.78     | 27962 | 89.9   | 28039 | 91.69  | —         | —          |
| 2015 | 教育服務業-服務及銷售工作人員            |  23678   | 94.93     | 22333    | …         | 23000    | …         | 24019 | 90.87  | 24324 | 91.90  | —         | —          |
| 2015 | 礦業及土石採取業-技術員及助理專業人員        |  29499   | 92.27     | —        | —         | —        | —         | 28940 | 91.75  | 29313 | 92.42  | 30450     | 92.63      |
| 2015 | 礦業及土石採取業-技藝\_機械設備操作及組裝人員   |  27809   | 87.07     | —        | —         | 27481    | 85.04     | 28088 | 86.26  | 28688 | 93.10  | —         | —          |
| 2015 | 礦業及土石採取業                   |  26570   | 92.75     | 22148    | 95.55     | 24087    | 88.18     | 25505 | 88.69  | 30232 | 95.28  | 32088     | 98.72      |
| 2015 | 其他服務業-事務支援人員               |  24620   | 95.99     | —        | —         | 22818    | 98.08     | 24146 | 95.8   | 25846 | 95.47  | 28700     | 98.23      |
| 2015 | 營造業-技藝\_機械設備操作及組裝人員        |  25487   | 96.93     | —        | —         | 24679    | 96.44     | 25758 | 97.71  | 26650 | 95.64  | —         | —          |
| 2015 | 用水供應及污染整治業-技藝\_機械設備操作及組裝人員 |  27097   | 97.29     | —        | —         | 26499    | 98.5      | 27359 | 95.89  | 27887 | 95.90  | —         | —          |
| 2015 | 營造業                        |  26558   | 96.69     | 23562    | 97.66     | 23606    | 95.85     | 25307 | 96.24  | 27748 | 96.35  | 32034     | 97.61      |
| 2015 | 教育服務業                      |  24730   | 96.64     | 21556    | 98.4      | 21907    | 98.31     | 23185 | 97.19  | 25162 | 96.44  | 29048     | 98.34      |

``` r
##107年度
#先將107欄位資料清洗後再轉為numeric
X107MonthSalary$`大學-女/男` <- gsub("…",NA,X107MonthSalary$`大學-女/男`)   
X107MonthSalary$`大學-女/男` <- gsub("—",NA,X107MonthSalary$`大學-女/男`)
X107MonthSalary$`大學-女/男` <- as.numeric(X107MonthSalary$`大學-女/男`)

#篩選女生比男生的比率小於100的資料
MLhigher107 <- filter(X107MonthSalary,`大學-女/男`<100)%>% arrange(`大學-女/男`)

#取出前10筆資料
MLheadin107<-head(MLhigher107,10)
knitr::kable(MLheadin107)
```

|    年度     | 大職業別                 | 經常性薪資-薪資 | 經常性薪資-女/男 | 國中及以下-薪資 | 國中及以下-女/男 | 高中或高職-薪資 | 高中或高職-女/男 | 專科-薪資 | 專科-女/男 | 大學-薪資 | 大學-女/男 | 研究所-薪資 | 研究所-女/男 |
| :-------: | :------------------- | :------- | :-------- | :------- | :-------- | :------- | :-------- | :---- | :----- | :---- | :----: | :----- | :------ |
|   2018    | 礦業及土石採取業-專業人員        | 36166    | 96.68     | —        | —         | —        | —         | —     | —      | 35036 | 96.02  | 37618  | 98.03   |
|   2018    | 電力及燃氣供應業-事務支援人員      | 27846    | 97.36     | —        | —         | 25740    | 99.28     | 26983 | 98.88  | 28721 | 96.96  | 31757  | 97.19   |
|   2018    | 礦業及土石採取業             | 26492    | 96.76     | 22745    | 98.2      | 24819    | 96.59     | 26027 | 98.82  | 27914 | 97.11  | 31946  | 93.66   |
|   2018    | 營建工程                 | 27702    | 97.59     | 23999    | 97.41     | 24703    | 98.06     | 26467 | 97.91  | 29154 | 97.52  | 33255  | 98.52   |
|   2018    | 教育業-事務支援人員           | 25074    | 98.91     | —        | —         | 22846    | 100       | 23277 | 100.26 | 25908 | 97.61  | 30827  | 96.24   |
|   2018    | 電力及燃氣供應業-服務及銷售工作人員   | 29138    | 99.27     | —        | —         | 28717    | 100       | 29115 | 100    | 29540 | 97.73  | —      | —       |
|   2018    | 營建工程-技術員及助理專業人員      | 29396    | 98.03     | —        | —         | —        | —         | 27753 | 97.45  | 29458 | 97.78  | 32691  | 98.91   |
|   2018    | 用水供應及污染整治業-專業人員      | 37010    | 98.6      | —        | —         | —        | —         | —     | —      | 34957 | 97.81  | 39866  | 99.56   |
|   2018    | 用水供應及污染整治業-服務及銷售工作人員 | 27908    | 99.04     | 24763    | 100       | 27468    | 100       | 28444 | 100    | 29487 | 97.94  | —      | —       |
|   2018    | 電力及燃氣供應業-專業人員        | 34795    | 98.97     | —        | —         | —        | —         | —     | —      | 34308 | 98.23  | 35491  | 100     |
| \#\#\# 哪些 | 行業女生薪資比男生薪資多?        |          |           |          |           |          |           |       |        |       |        |        |         |

``` r
##104年度

#篩選女生比男生的比率大於100的資料
FMhigher104 <- filter(X104MonthSalary,`大學-女/男`>100)%>% arrange(`大學-女/男`)

#取出前10筆資料
FMheadin104<-head(FMhigher104,10)
knitr::kable(FMheadin104)
```

|  年度  | 大職業別                         | 經常性薪資-薪資 | 經常性薪資-女/男 | 國中及以下-薪資 | 國中及以下-女/男 | 高中或高職-薪資 | 高中或高職-女/男 | 專科-薪資 | 專科-女/男 | 大學-薪資 | 大學-女/男 | 研究所及以上-薪資 | 研究所及以上-女/男 |
| :--: | :--------------------------- | :------: | :-------- | :------- | :-------- | :------- | :-------- | :---- | :----- | :---- | :----: | :-------- | :--------- |
| 2015 | 專業\_科學及技術服務業-技藝\_機械設備操作及組裝人員 |  25678   | 100.29    | —        | —         | 24179    | 99.65     | 25838 | 99.97  | 27294 | 100.26 | —         | —          |

``` r
##107年度

#篩選女生比男生的比率小於100的資料
FMhigher107 <- filter(X107MonthSalary,`大學-女/男`>100)%>% arrange(`大學-女/男`)

#取出前10筆資料
FMheadin107<-head(FMhigher107,10)
knitr::kable(FMheadin107)
```

| 年度 | 大職業別 | 經常性薪資-薪資 | 經常性薪資-女/男 | 國中及以下-薪資 | 國中及以下-女/男 | 高中或高職-薪資 | 高中或高職-女/男 | 專科-薪資 | 專科-女/男 | 大學-薪資 | 大學-女/男 | 研究所-薪資 | 研究所-女/男 |
| -: | :--- | :------- | :-------- | :------- | :-------- | :------- | :-------- | :---- | :----- | :---- | -----: | :----- | :------ |

## 研究所薪資差異

以107年度的資料來看，哪個職業別念研究所最划算呢 (研究所學歷薪資與大學學歷薪資增加比例最多)?

``` r
#先將大學薪資、研究所及以上欄位改為numeric
X107MonthSalary$`大學-薪資` <- gsub("…",NA,X107MonthSalary$`大學-薪資`) 
X107MonthSalary$`大學-薪資` <- gsub("—",NA,X107MonthSalary$`大學-薪資`)
X107MonthSalary$`研究所-薪資` <- gsub("…",NA,X107MonthSalary$`研究所-薪資`)   
X107MonthSalary$`研究所-薪資` <- gsub("—",NA,X107MonthSalary$`研究所-薪資`)
X107MonthSalary$`大學-薪資`<-as.numeric(X107MonthSalary$`大學-薪資`)
X107MonthSalary$`研究所-薪資`<-as.numeric(X107MonthSalary$`研究所-薪資`)
#利用mutate()新增研究所及以上除以大學薪資欄位
mutate107<-mutate(X107MonthSalary,Rate=`研究所-薪資`/`大學-薪資`)
#利用arrange()由大到小進行排序
arrange107<-arrange(mutate107,desc(Rate))

#取出前10筆
knitr::kable(select(arrange107,`大職業別`,`大學-薪資`,`研究所-薪資`,Rate)%>%head(10))
```

| 大職業別                   | 大學-薪資 | 研究所-薪資 |     Rate |
| :--------------------- | :---: | :----: | -------: |
| 其他服務業                  | 25781 | 31909  | 1.237694 |
| 專業\_科學及技術服務業           | 29353 | 35381  | 1.205362 |
| 專業\_科學及技術服務業-專業人員      | 32460 | 39103  | 1.204652 |
| 教育業-事務支援人員             | 25908 | 30827  | 1.189864 |
| 出版、影音製作、傳播及資通訊服務業      | 29143 | 34503  | 1.183921 |
| 其他服務業-事務支援人員           | 26115 | 30830  | 1.180548 |
| 出版、影音製作、傳播及資通訊服務業-專業人員 | 31763 | 37479  | 1.179958 |
| 製造業                    | 28777 | 33916  | 1.178580 |
| 工業                     | 28850 | 33893  | 1.174801 |
| 工業及服務業                 | 28849 | 33880  | 1.174391 |

## 我有興趣的職業別薪資狀況分析

我有興趣的大職業類別為「專業\_科學及技術服務業-專業人員」 以及 「專業\_科學及技術服務業-服務及銷售工作人」
「專業\_科學及技術服務業-專業人員」大學畢業薪水平均為32460
研究所畢業薪水平均為39103
「專業\_科學及技術服務業-服務及銷售工作人員」大學畢業薪水平均為28304
研究所畢業薪水平均為NA無資料

薪資其實都比我想像的略低一些，研究所的薪水更使高於大學6K左右，可是已經大四念研究所也來不及了，希望在別人念研究所的兩年內，能在職場上獲得更大的收穫。

### 有興趣的職業別篩選，呈現薪資

``` r
X107MonthSalary<-mutate(X107MonthSalary,range=`研究所-薪資`-`大學-薪資`)
career<-select(X107MonthSalary,大職業別,`大學-薪資`,`研究所-薪資`)%>%filter(大職業別=="專業_科學及技術服務業-專業人員"|大職業別=="專業_科學及技術服務業-服務及銷售工作人員")
knitr::kable(career)
```

| 大職業別                   | 大學-薪資 | 研究所-薪資 |
| :--------------------- | :---: | :----: |
| 專業\_科學及技術服務業-專業人員      | 32460 | 39103  |
| 專業\_科學及技術服務業-服務及銷售工作人員 | 28304 |   NA   |

### 這些職業別研究所薪資與大學薪資差多少呢？

``` r
salaryrange<-select(X107MonthSalary,大職業別,range)%>%filter(大職業別=="專業_科學及技術服務業-專業人員"|大職業別=="專業_科學及技術服務業-服務及銷售工作人員")
knitr::kable(salaryrange)
```

| 大職業別                   | range |
| :--------------------- | ----: |
| 專業\_科學及技術服務業-專業人員      |  6643 |
| 專業\_科學及技術服務業-服務及銷售工作人員 |    NA |
